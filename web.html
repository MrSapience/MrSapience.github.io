<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Display Website</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f8ff; /* Light mode background */
            color: #333; /* Light mode text color */
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s; /* Transition for dark mode */
        }
        body.dark-mode {
            background-color: #333; /* Dark mode background */
            color: #f0f8ff; /* Dark mode text color */
        }
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #ffffff; /* Light mode container background */
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Soft shadow */
            transition: background-color 0.3s; /* Transition for dark mode */
        }
        body.dark-mode .container {
            background-color: #444; /* Dark mode container background */
        }
        .upload-area {
            border: 2px dashed #007bff;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            background-color: #e6f7ff; /* Light blue background */
        }
        body.dark-mode .upload-area {
            background-color: #555; /* Dark mode upload area background */
            border-color: #0056b3; /* Dark mode border color */
        }
        .upload-area input[type="file"] {
            display: none;
        }
        .upload-area label {
            display: inline-block;
            padding: 10px 20px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
        }
        body.dark-mode .upload-area label {
            background-color: #0056b3; /* Dark mode button color */
        }
        .question {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9; /* Light gray background for questions */
            border-radius: 5px;
        }
        body.dark-mode .question {
            background-color: #666; /* Dark mode question background */
        }
        .answers {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }
        .answers li {
            margin: 10px 0;
        }
        .answers button {
            padding: 10px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            width: 100%;
            text-align: left;
            transition: background-color 0.3s;
        }
        body.dark-mode .answers button {
            background-color: #0056b3; /* Dark mode answer button color */
        }
        .correct {
            background-color: green !important; /* Highlight correct answers */
        }
        .incorrect {
            background-color: red !important; /* Highlight incorrect answers */
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9f7ef; /* Light green background for results */
            border-radius: 5px;
        }
        body.dark-mode .results {
            background-color: #4caf50; /* Dark mode results background */
        }
        .reset-button {
            margin-top: 20px;
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #ff5722; /* Red background for reset */
            color: white;
            transition: background-color 0.3s;
        }
        .reset-button:hover {
            background-color: #e64a19;
        }
        .toggle-button {
            padding: 10px;
            cursor: pointer;
            margin-top: 20px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
        }
        .toggle-button:hover {
            background-color: #0056b3;
        }
        .option-button {
            margin-top: 20px;
            padding: 10px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #ffc107; /* Yellow background for option button */
            color: black;
            transition: background-color 0.3s;
        }
        .option-button:hover {
            background-color: #e0a800;
        }
    </style>
</head>
<body>
    <header>
        <h1>Test Display Website</h1>
        <button class="toggle-button" id="toggleButton">Switch to Dark Mode</button>
        <button class="option-button" id="toggleCorrectAnswer">Show Correct Answer After Wrong Click: ON</button>
    </header>
    <div class="container">
        <div class="upload-area">
            <input type="file" id="fileInput" accept=".txt">
            <label for="fileInput">Upload Test File</label>
        </div>
        <div id="testContent"></div>
        <button class="reset-button" id="resetButton" style="display: none;">Reset Progress</button>
        <div id="results" class="results" style="display: none;"></div>
    </div>
    <script>
        let score = 0;
        let totalQuestions = 0;
        let incorrectQuestions = []; // Store questions with incorrect answers
        let showCorrectAnswer = true; // Default to showing correct answer after wrong click

        document.getElementById('fileInput').addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const content = e.target.result;
                    displayTest(content);
                };
                reader.readAsText(file);
            }
        });

        function displayTest(content) {
            const testContent = document.getElementById('testContent');
            testContent.innerHTML = '';
            const lines = content.split('\n');
            let question = '';
            let answers = [];
            totalQuestions = 0; // Reset total questions count
            lines.forEach(line => {
                if (line.match(/^\d+\)/)) {
                    if (question) {
                        createQuestionElement(question, answers, testContent);
                        answers = [];
                    }
                    question = line;
                } else if (line.match(/^\d+\./)) {
                    answers.push(line);
                }
            });
            if (question) {
                createQuestionElement(question, answers, testContent);
            }
            document.getElementById('resetButton').style.display = 'block'; // Show reset button
            score = 0; // Reset score for new test
            incorrectQuestions = []; // Reset incorrect questions
            document.getElementById('results').style.display = 'none'; // Hide results
        }

        function createQuestionElement(question, answers, container) {
            const questionElem = document.createElement('div');
            questionElem.classList.add('question');
            questionElem.innerText = question;

            const answersElem = document.createElement('ul');
            answersElem.classList.add('answers');

            answers.forEach(answer => {
                const answerElem = document.createElement('li');
                const button = document.createElement('button');
                button.innerText = answer.replace(/\|/g, '');
                button.dataset.correct = answer.includes('|');
                button.addEventListener('click', checkAnswer);
                answerElem.appendChild(button);
                answersElem.appendChild(answerElem);
            });

            questionElem.appendChild(answersElem);
            container.appendChild(questionElem);
            totalQuestions++; // Increment total questions count
        }

        function checkAnswer(event) {
            const clickedButton = event.target;
            const isCorrect = clickedButton.dataset.correct === 'true';
            const questionElem = clickedButton.closest('.question');

            if (!isCorrect) {
                // Highlight incorrect answer
                clickedButton.classList.add('incorrect');
                incorrectQuestions.push(questionElem.innerText); // Store question text for incorrect answers
                
                if (showCorrectAnswer) {
                    // Show the correct answer if the option is ON
                    const correctButton = Array.from(questionElem.querySelectorAll('button')).find(btn => btn.dataset.correct === 'true');
                    if (correctButton) {
                        correctButton.classList.add('correct'); // Highlight correct answer
                        correctButton.disabled = true; // Disable the correct answer button
                    }
                }
            } else {
                clickedButton.classList.add('correct'); // Highlight correct answer
            }

            // Disable all buttons after answering
            const buttons = questionElem.querySelectorAll('button');
            buttons.forEach(button => button.disabled = true);

            // Show results after answering all questions
            if (document.querySelectorAll('.question').length === document.querySelectorAll('.question .answers button:disabled').length) {
                displayResults();
            }
        }

        function displayResults() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `Your score: ${score} out of ${totalQuestions}`;
            if (incorrectQuestions.length > 0) {
                resultsDiv.innerHTML += `<br>You answered the following questions incorrectly: <br>${incorrectQuestions.join('<br>')}`;
            }
            resultsDiv.style.display = 'block';
        }

        document.getElementById('resetButton').addEventListener('click', function() {
            const testContent = document.getElementById('testContent');
            testContent.innerHTML = ''; // Clear test content
            this.style.display = 'none'; // Hide reset button
            document.getElementById('results').style.display = 'none'; // Hide results
            score = 0; // Reset score
            incorrectQuestions = []; // Reset incorrect questions
        });

        document.getElementById('toggleButton').addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            this.innerText = document.body.classList.contains('dark-mode') ? 'Switch to Light Mode' : 'Switch to Dark Mode';
        });

        document.getElementById('toggleCorrectAnswer').addEventListener('click', function() {
            showCorrectAnswer = !showCorrectAnswer; // Toggle the option
            this.innerText = `Show Correct Answer After Wrong Click: ${showCorrectAnswer ? 'ON' : 'OFF'}`;
        });
    </script>
</body>
</html>
